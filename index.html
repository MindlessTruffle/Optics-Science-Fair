<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Prototype Optics Site</title>
  <style>
    body, html {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      font-family: Arial, sans-serif;
    }
    #video-container {
      position: relative;
      width: 100%;
      height: 100%;
    }
    video {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.7);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      color: white;
    }
    .button {
      background-color: #28a745;
      color: white;
      border: none;
      padding: 15px 30px;
      font-size: 18px;
      border-radius: 5px;
      cursor: pointer;
      position: absolute;
      bottom: 30%;
      left: 50%;
      transform: translateX(-50%);
    }
    .button:hover {
      background-color: #218838;
    }
    .text-box {
      position: absolute;
      bottom: 20%;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0, 0, 0, 0.7);
      color: white;
      padding: 20px;
      border-radius: 10px;
      max-width: 80%;
      text-align: center;
    }
  </style>
</head>
<body>
  <div id="video-container">
    <video id="video-player" autoplay muted loop>
      <source id="video-source" src="https://codehs.com/uploads/9718d24073c4d3ffceb15dfa51faf93e" type="video/mp4">
    </video>
    <div id="overlay" class="overlay">
      <h1>A Very Serious Exploration of the Human Eye</h1>
      <button id="start-button" class="button">Change Your <strong>Perspective</strong> Forever</button>
    </div>
  </div>
  
  <script>
    // this may be put ina script.js later - not totally necessary
    const videoData = [
      { file: "https://codehs.com/uploads/9718d24073c4d3ffceb15dfa51faf93e", transition: "https://codehs.com/uploads/27ffff1ad2053dc83d889d9423f739cb", text: "info abt part 1" },
      { file: "https://codehs.com/uploads/9718d24073c4d3ffceb15dfa51faf93e", transition: "https://codehs.com/uploads/27ffff1ad2053dc83d889d9423f739cb", text: "infoo abt part 2" },
      { file: "https://codehs.com/uploads/9718d24073c4d3ffceb15dfa51faf93e", transition: null, text: "info abt last part" }
    ];

    const videoPlayer = document.getElementById("video-player");
    const videoSource = document.getElementById("video-source");
    const overlay = document.getElementById("overlay");
    const startButton = document.getElementById("start-button");
    const videoContainer = document.getElementById("video-container");

    let currentIndex = -1;
    let nextButton, textBox;

    function clearUI() {
      if (nextButton) nextButton.remove();
      if (textBox) textBox.remove();
    }

    function seamlessPlay(newSource) {
      const tempVideo = document.createElement("video");
      tempVideo.src = newSource;
      tempVideo.muted = true;
      tempVideo.load();
      tempVideo.oncanplaythrough = () => {
        videoSource.src = newSource;
        videoPlayer.load();
        videoPlayer.play();
      };
    }

    function loadVideo(index) {
      clearUI();

      const { file, text, transition } = videoData[index];
      seamlessPlay(file);
      videoPlayer.loop = true;

      textBox = document.createElement("div");
      textBox.className = "text-box";
      textBox.innerText = text;

      nextButton = document.createElement("button");
      nextButton.className = "button";
      nextButton.innerText = "Next";
      nextButton.addEventListener("click", () => {
        clearUI()
        videoPlayer.loop = false;
        if (transition) {
          videoPlayer.onended = () => {
            seamlessPlay(transition);
            videoPlayer.loop = false;
            videoPlayer.onended = () => {
              currentIndex++;
              if (currentIndex < videoData.length) {
                loadVideo(currentIndex);
              }
            };
          };
        } else {
          videoPlayer.onended = () => {
            overlay.innerHTML = '<h1>Thanks for Learning</h1><button id="restart-button" class="button">Restart</button>';
            overlay.style.display = "flex";
            document.getElementById("restart-button").addEventListener("click", () => {
              location.reload();
            });
          };
        }
        videoPlayer.play();
      });

      videoContainer.appendChild(textBox);
      videoContainer.appendChild(nextButton);
    }

    startButton.addEventListener("click", () => {
      overlay.style.display = "none";
      videoPlayer.loop = false;
      videoPlayer.onended = () => {
        currentIndex = 0;
        loadVideo(currentIndex);
      };
    });
  </script>
</body>
</html>
