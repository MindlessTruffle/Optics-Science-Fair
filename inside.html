<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Inside of Eye</title>
  <style>
    body, html {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      overflow: hidden;
      font-family: Arial, sans-serif;
    }
    #video-container {
      position: relative;
      width: 100%;
      height: 100%;
    }
    video {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      color: white;
    }
    
    .first_button { 
      animation: shake 0.82s cubic-bezier(.36, .07, .19, .97) both infinite; 
      background-color: #28a745; 
      color: white; 
      border: none; 
      padding: 15px 30px; 
      font-size: 18px; 
      border-radius: 5px; 
      cursor: pointer; 
      position: relative;
      backface-visibility: hidden; 
      perspective: 1000px; 
    } 
    @keyframes shake { 
      10%, 90% { transform: translate3d(-1px, 0, 0); } 
      20%, 80% { transform: translate3d(2px, 0, 0); } 
      30%, 50%, 70% { transform: translate3d(-4px, 0, 0); } 
      40%, 60% { transform: translate3d(4px, 0, 0); } 
    }
    
    .first_button:hover {
      background-color: #DC143C;
    }
    
    .button {
      background-color: #28a745;
      color: white;
      border: none;
      padding: 15px 30px;
      font-size: 18px;
      border-radius: 5px;
      cursor: pointer;
      position: absolute;
      bottom: 50%;
      left: 50%;
      transform: translate(-50%);
    }
    
    .button:hover {
      background-color: #218838;
    }
    .text-box {
      position: absolute;
      bottom: 20%;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0, 0, 0, 0.7);
      color: white;
      padding: 20px;
      border-radius: 10px;
      max-width: 80%;
      text-align: center;
    }
  </style>
</head>
<body>
  <div id="video-container">
    <video id="video-player" autoplay muted loop>
      <source id="video-source" src="https://codehs.com/uploads/05c3c59417b9bb25c605b8963987a452" type="video/mp4">
    </video>
    <div id="overlay" class="overlay">
      <button id="start-button" class="first_button">ENTER THE EYE</button>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function(event) {
      document.querySelector('body').style.opacity = 1
    })
    
    const videoData = [
      { 
        file: "https://codehs.com/uploads/3298fa0018597226da269f8e49d7987d", 
        initialTransition: "https://codehs.com/uploads/8573682af5bd54fbe2870f7876168d19",
        transition: "https://codehs.com/uploads/27ffff1ad2053dc83d889d9423f739cb", 
        text: "The cornea focuses light entering the eye." 
      },
      { 
        file: "https://codehs.com/uploads/9718d24073c4d3ffceb15dfa51faf93e", 
        transition: "https://codehs.com/uploads/27ffff1ad2053dc83d889d9423f739cb", 
        text: "The lens adjusts focus for clear vision." 
      },
      { 
        file: "https://codehs.com/uploads/9718d24073c4d3ffceb15dfa51faf93e", 
        transition: null, 
        text: "The retina converts light into neural signals." 
      }
    ];

    const videoPlayer = document.getElementById("video-player");
    const videoSource = document.getElementById("video-source");
    const overlay = document.getElementById("overlay");
    const startButton = document.getElementById("start-button");
    const videoContainer = document.getElementById("video-container");

    let currentIndex = -1;
    let nextButton, textBox;

    function clearUI() {
      if (nextButton) nextButton.remove();
      if (textBox) textBox.remove();
    }

    function seamlessPlay(newSource) {
      const tempVideo = document.createElement("video");
      tempVideo.src = newSource;
      tempVideo.muted = true;
      tempVideo.load();
      tempVideo.oncanplaythrough = () => {
        videoSource.src = newSource;
        videoPlayer.load();
        videoPlayer.play();
      };
    }

    function loadVideo(index) {
      clearUI();

      const { file, text, transition } = videoData[index];
      seamlessPlay(file);
      videoPlayer.loop = true;

      textBox = document.createElement("div");
      textBox.className = "text-box";
      textBox.innerText = text;

      nextButton = document.createElement("button");
      nextButton.className = "button";
      nextButton.innerText = "Next";
      nextButton.addEventListener("click", () => {
        videoPlayer.loop = false;
        if (transition) {
          clearUI();
          videoPlayer.onended = () => {
            seamlessPlay(transition);
            videoPlayer.loop = false;
            videoPlayer.onended = () => {
              currentIndex++;
              if (currentIndex < videoData.length) {
                loadVideo(currentIndex);
              }
            };
          };
        } else {
          videoPlayer.onended = () => {
            clearUI();
            overlay.innerHTML = '<h1>Thanks for Learning</h1><button id="restart-button" class="button">Restart</button>';
            overlay.style.display = "flex";
            document.getElementById("restart-button").addEventListener("click", () => {
              location.reload();
            });
          };
        }
        videoPlayer.play();
      });

      videoContainer.appendChild(textBox);
      videoContainer.appendChild(nextButton);
    }

    startButton.addEventListener("click", () => {
      overlay.style.display = "none";
      
      const currentTime = videoPlayer.currentTime;
      const duration = videoPlayer.duration;
      
      const timeToEndOfLoop = duration - currentTime;
      
      videoPlayer.loop = false;
      
      videoPlayer.onended = () => {
        seamlessPlay(videoData[0].initialTransition);
        videoPlayer.loop = false;
        videoPlayer.onended = () => {
          currentIndex = 0;
          loadVideo(currentIndex);
        };
      };
    });
  </script>
</body>
</html>
